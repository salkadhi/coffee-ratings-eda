coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Total score")+
xlab("Measure")
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")
library(ggpmisc)
install.packages("ggpmisc")
library(ggpmisc)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = 8.5, label.y = 25, size = 5)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = 8.5, label.y = 25, size = 1)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")))
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = 8.5, label.y = 25, size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "left", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "top", label.y = "left", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "top", label.y = "left", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "top", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 4),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "left", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = 'text',
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "left", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 3), sep = "")),
label.x = "left", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "left", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "top", label.y = "left", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "left", label.y = "top", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point() +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha()) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.1 ) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.1, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.1, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 2),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 3)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.1, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 1),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.5, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p-value=", signif(..p.value.., digits = 1),
"   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.5, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 1),
"   R^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.5, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 1),
"   R^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 3)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.5, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 1),
"   R^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.5, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 0),
"   R^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.5, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 0),
"\nR^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.8, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 0),
"\nR^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
#load libraries and dataset
library(tidyverse)
library(viridis)
library(ggpmisc)
coffee_ratings <- read_csv(here("data/coffee_ratings.csv"))
#model total score vs different grades
coffee_ratings[coffee_ratings$total_cup_points>0,] %>% select(total_cup_points, grades) %>% pivot_longer(-total_cup_points, names_to = "Measures", values_to = "Score")%>%
ggplot(aes(x = total_cup_points, y = Score))+
geom_point(alpha = 0.8, size=0.1) +
geom_smooth(method="lm", na.rm = TRUE, se = FALSE)+
coord_flip() +
facet_wrap(vars(Measures)) +
ylab("Measure")+
xlab("Total score")+
stat_fit_glance(method = 'lm',
method.args = list(formula = y ~ x),  geom = "text_npc",
aes(label = paste("p=", signif(..p.value.., digits = 0),
"\nR^2=", signif(..r.squared.., digits = 2), sep = "")),
label.x = "right", label.y = "bottom", size = 2)
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D")
coffee_ratings %>%
count(country_of_origin, sort=TRUE) %>%
top_n(12) %>%
select(country_of_origin) -> top12countries
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
lab(x="gshdfg")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="gshdfg")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")
coffee_ratings %>%
count(country_of_origin, sort=TRUE) %>%
top_n(20) %>%
ggplot(aes(reorder(country_of_origin, n), (n)))+
geom_col()+
coord_flip()+
ylab("Countries")+xlab("Count")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500, altitude_mean_meters >60) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")+-
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500, altitude_mean_meters >3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500, altitude_mean_meters >60) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500, altitude_mean_meters >70) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500 & altitude_mean_meters >70) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Mean altitude")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Mean altitude", color="Average Rating")
coffee_ratings[coffee_ratings$country_of_origin %in% top12countries[["country_of_origin"]],] %>%
filter(total_cup_points > 0) %>%
mutate(country = fct_reorder(country_of_origin, total_cup_points, .fun = max)) %>%
filter(total_cup_points > 0, altitude_mean_meters <=3500) %>%
ggplot(aes(country, total_cup_points, color=altitude_mean_meters, )) + geom_point() + coord_flip() +scale_color_viridis(option = "D") +
labs(x="Country", y="Average Rating", color="Mean altitude")
library(pacman)
pacman::p_load(data.table, fixest, BatchGetSymbols, finreportr, ggplot2, lubridate)
## Set parameters
first.date <- Sys.Date() - 2500
last.date <- Sys.Date()
freq.data <- "monthly"
tickers <- c("TSLA", "NIO", "PRPL", "AAPL", "SNAP", "MU", "AMD",
"NVDA", "TWTR")
## Get Stock Prices
stocks <- BatchGetSymbols(tickers = tickers,
first.date = first.date,
last.date = last.date,
freq.data = freq.data,
do.cache = FALSE,
thresh.bad.data = 0)
## Verify Returns
stocks_DT <- stocks$df.tickers %>% setDT() %>%          # Convert to data.table
.[order(ticker, ref.date)]                           # Order by ticker and date
## Graph Returns and Prices
returns_plot_all <- ggplot(stocks_DT, aes(x= ref.date, y = ret.adjusted.prices, colour = ticker)) +
geom_line() + theme_bw() + labs(title = "", x = "Date", y= "Monthly Returns", subtitle = "")
price_plot_all <- ggplot(stocks_DT, aes(x= ref.date, y = price.close, colour = ticker)) +
geom_line() + theme_bw() + labs(title = "", x = "Date", y= "Closing Price", subtitle = "")
returns_sep <- ggplot(stocks_DT[ticker %in% c("AAPL", "PRPL", "SNAP", "TSLA")], aes(x = ref.date, y = ret.adjusted.prices)) + geom_line() + facet_wrap(~ticker, scales = "free_y") + theme_bw()
prices_sep <- ggplot(stocks_DT[ticker %in% c("AAPL", "PRPL", "SNAP", "TSLA")], aes(x = ref.date, y = price.close)) + geom_line() + facet_wrap(~ticker, scales = "free_y") + theme_bw()
## All stock tickers in SP 500
df.SP500 <- GetSP500Stocks()
tickers <- df.SP500$Tickers
